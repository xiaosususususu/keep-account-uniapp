{"version":3,"file":"record.js","sources":["pages/record/record.vue","pages/record/record.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view v-if=\"players.length === 0\" class=\"empty-tip\">\r\n\t\t\t<text>请先添加玩家</text>\r\n\t\t\t<button class=\"go-to-players\" type=\"primary\" @click=\"goToPlayers\">去添加</button>\r\n\t\t</view>\r\n\r\n\t\t<view v-else class=\"record-form\">\r\n\t\t\t<view class=\"form-header\">\r\n\t\t\t\t<text class=\"title\">记录本局得分</text>\r\n\t\t\t\t<text class=\"current-date\">{{ currentDate }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"players-input\">\r\n\t\t\t\t<view v-for=\"player in players\" :key=\"player.id\" class=\"player-score-input\">\r\n\t\t\t\t\t<view class=\"player-header\">\r\n\t\t\t\t\t\t<text class=\"player-name\">{{ player.name }}</text>\r\n\t\t\t\t\t\t<text class=\"current-score\">当前总分: {{ player.totalScore }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"input-wrapper\">\r\n\t\t\t\t\t\t<button class=\"score-btn minus\" @click=\"adjustScore(player.id, -10)\">-10</button>\r\n\t\t\t\t\t\t<input class=\"score-input\"\r\n\t\t\t\t\t\t\t   type=\"number\"\r\n\t\t\t\t\t\t\t   v-model=\"scores[player.id]\"\r\n\t\t\t\t\t\t\t   placeholder=\"输入得分\"\r\n\t\t\t\t\t\t\t   @blur=\"validateInput(player.id)\" />\r\n\t\t\t\t\t\t<button class=\"score-btn plus\" @click=\"adjustScore(player.id, 10)\">+10</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"form-actions\">\r\n\t\t\t\t<button class=\"reset-btn\" @click=\"resetScores\">重置</button>\r\n\t\t\t\t<button class=\"save-btn\" type=\"primary\" @click=\"saveScores\">保存</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { DataManager } from '@/utils/dataManager.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tplayers: [],\r\n\t\t\tscores: {}\r\n\t\t}\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tcurrentDate() {\r\n\t\t\tconst now = new Date();\r\n\t\t\tconst year = now.getFullYear();\r\n\t\t\tconst month = String(now.getMonth() + 1).padStart(2, '0');\r\n\t\t\tconst day = String(now.getDate()).padStart(2, '0');\r\n\t\t\tconst hours = String(now.getHours()).padStart(2, '0');\r\n\t\t\tconst minutes = String(now.getMinutes()).padStart(2, '0');\r\n\t\t\treturn `${year}-${month}-${day} ${hours}:${minutes}`;\r\n\t\t}\r\n\t},\r\n\r\n\tonShow() {\r\n\t\tthis.loadPlayers();\r\n\t\tthis.resetScores();\r\n\t},\r\n\r\n\tmethods: {\r\n\t\tloadPlayers() {\r\n\t\t\tthis.players = DataManager.getPlayers();\r\n\t\t\tthis.scores = {};\r\n\t\t\tthis.players.forEach(player => {\r\n\t\t\t\tthis.scores[player.id] = '';\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tadjustScore(playerId, amount) {\r\n\t\t\tconst currentValue = parseInt(this.scores[playerId]) || 0;\r\n\t\t\tthis.scores[playerId] = (currentValue + amount).toString();\r\n\t\t},\r\n\r\n\t\tvalidateInput(playerId) {\r\n\t\t\tconst value = this.scores[playerId];\r\n\t\t\tif (value === '' || value === null || value === undefined) {\r\n\t\t\t\tthis.scores[playerId] = '';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst numValue = parseInt(value);\r\n\t\t\tif (isNaN(numValue)) {\r\n\t\t\t\tthis.scores[playerId] = '0';\r\n\t\t\t} else {\r\n\t\t\t\tthis.scores[playerId] = numValue.toString();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tresetScores() {\r\n\t\t\tthis.players.forEach(player => {\r\n\t\t\t\tthis.scores[player.id] = '';\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tsaveScores() {\r\n\t\t\tconst hasScores = Object.values(this.scores).some(score => score !== '' && score !== null && score !== undefined);\r\n\r\n\t\t\tif (!hasScores) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请至少输入一位玩家的得分',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst gameRecord = {\r\n\t\t\t\tid: Date.now().toString(),\r\n\t\t\t\tdate: new Date().toISOString(),\r\n\t\t\t\tplayers: []\r\n\t\t\t};\r\n\r\n\t\t\tlet hasValidScore = false;\r\n\t\t\tthis.players.forEach(player => {\r\n\t\t\t\tconst score = parseInt(this.scores[player.id]) || 0;\r\n\t\t\t\tif (score !== 0) {\r\n\t\t\t\t\thasValidScore = true;\r\n\t\t\t\t}\r\n\t\t\t\tgameRecord.players.push({\r\n\t\t\t\t\tid: player.id,\r\n\t\t\t\t\tname: player.name,\r\n\t\t\t\t\tscore: score,\r\n\t\t\t\t\ttotalScore: player.totalScore + score\r\n\t\t\t\t});\r\n\r\n\t\t\t\tDataManager.updatePlayerTotal(player.id, score);\r\n\t\t\t});\r\n\r\n\t\t\tDataManager.saveGameRecord(gameRecord);\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '保存成功',\r\n\t\t\t\ticon: 'success'\r\n\t\t\t});\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.resetScores();\r\n\t\t\t\tthis.loadPlayers();\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\r\n\t\tgoToPlayers() {\r\n\t\t\tuni.switchTab({\r\n\t\t\t\turl: '/pages/players/players'\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n\tpadding: 30rpx;\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n}\r\n\r\n.empty-tip {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 100rpx 0;\r\n\tcolor: #999;\r\n}\r\n\r\n.go-to-players {\r\n\tmargin-top: 30rpx;\r\n}\r\n\r\n.record-form {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 15rpx;\r\n\tpadding: 30rpx;\r\n\tbox-shadow: 0 2rpx 10rpx rgba(0,0,0,0.1);\r\n}\r\n\r\n.form-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 40rpx;\r\n\tpadding-bottom: 20rpx;\r\n\tborder-bottom: 1rpx solid #eee;\r\n}\r\n\r\n.title {\r\n\tfont-size: 36rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.current-date {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.players-input {\r\n\r\n}\r\n\r\n.player-score-input {\r\n\tmargin-bottom: 40rpx;\r\n\tpadding: 25rpx;\r\n\tbackground-color: #f8f8f8;\r\n\tborder-radius: 10rpx;\r\n}\r\n\r\n.player-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.player-name {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.current-score {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.input-wrapper {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.score-btn {\r\n\twidth: 80rpx;\r\n\theight: 70rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 28rpx;\r\n\tborder-radius: 8rpx;\r\n}\r\n\r\n.minus {\r\n\tbackground-color: #fff2f0;\r\n\tcolor: #ff4d4f;\r\n\tborder: 1rpx solid #ffccc7;\r\n}\r\n\r\n.plus {\r\n\tbackground-color: #e6f7e6;\r\n\tcolor: #52c41a;\r\n\tborder: 1rpx solid #b7eb8f;\r\n}\r\n\r\n.score-input {\r\n\tflex: 1;\r\n\theight: 70rpx;\r\n\tpadding: 0 20rpx;\r\n\tborder: 1rpx solid #ddd;\r\n\tborder-radius: 8rpx;\r\n\tfont-size: 30rpx;\r\n\ttext-align: center;\r\n\tbackground-color: #fff;\r\n}\r\n\r\n.form-actions {\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n\tmargin-top: 40rpx;\r\n}\r\n\r\n.reset-btn, .save-btn {\r\n\tflex: 1;\r\n\theight: 80rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 32rpx;\r\n\tborder-radius: 8rpx;\r\n}\r\n\r\n.reset-btn {\r\n\tbackground-color: #f5f5f5;\r\n\tcolor: #666;\r\n\tborder: 1rpx solid #ddd;\r\n}\r\n</style>","import MiniProgramPage from '/Users/suchengbo/code/AI/kepp-account-uniapp/pages/record/record.vue'\nwx.createPage(MiniProgramPage)"],"names":["DataManager","uni"],"mappings":"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"}