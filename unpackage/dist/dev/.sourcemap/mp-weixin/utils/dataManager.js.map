{"version":3,"file":"dataManager.js","sources":["utils/dataManager.js"],"sourcesContent":["export const StorageKeys = {\r\n\tPLAYERS: 'card_players',\r\n\tGAME_HISTORY: 'card_game_history',\r\n\tCURRENT_TOTAL: 'card_current_total'\r\n}\r\n\r\nexport const storage = {\r\n\tset(key, data) {\r\n\t\ttry {\r\n\t\t\tuni.setStorageSync(key, JSON.stringify(data));\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('存储数据失败:', e);\r\n\t\t}\r\n\t},\r\n\r\n\tget(key, defaultValue = null) {\r\n\t\ttry {\r\n\t\t\tconst data = uni.getStorageSync(key);\r\n\t\t\treturn data ? JSON.parse(data) : defaultValue;\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('读取数据失败:', e);\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\t},\r\n\r\n\tremove(key) {\r\n\t\ttry {\r\n\t\t\tuni.removeStorageSync(key);\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('删除数据失败:', e);\r\n\t\t}\r\n\t},\r\n\r\n\tclear() {\r\n\t\ttry {\r\n\t\t\tuni.clearStorageSync();\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('清空数据失败:', e);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const DataManager = {\r\n\tgetPlayers() {\r\n\t\treturn storage.get(StorageKeys.PLAYERS, []);\r\n\t},\r\n\r\n\tsavePlayers(players) {\r\n\t\tstorage.set(StorageKeys.PLAYERS, players);\r\n\t},\r\n\r\n\tgetGameHistory() {\r\n\t\treturn storage.get(StorageKeys.GAME_HISTORY, []);\r\n\t},\r\n\r\n\tsaveGameRecord(record) {\r\n\t\tconst history = this.getGameHistory();\r\n\t\thistory.unshift(record);\r\n\t\tstorage.set(StorageKeys.GAME_HISTORY, history);\r\n\t},\r\n\r\n\tupdatePlayerTotal(playerId, score) {\r\n\t\tconst players = this.getPlayers();\r\n\t\tconst playerIndex = players.findIndex(p => p.id === playerId);\r\n\t\tif (playerIndex !== -1) {\r\n\t\t\tplayers[playerIndex].totalScore += score;\r\n\t\t\tthis.savePlayers(players);\r\n\t\t}\r\n\t},\r\n\r\n\tclearAllData() {\r\n\t\tstorage.remove(StorageKeys.PLAYERS);\r\n\t\tstorage.remove(StorageKeys.GAME_HISTORY);\r\n\t}\r\n}"],"names":["uni"],"mappings":";;AAAY,MAAC,cAAc;AAAA,EAC1B,SAAS;AAAA,EACT,cAAc;AAAA,EACd,eAAe;AAChB;AAEY,MAAC,UAAU;AAAA,EACtB,IAAI,KAAK,MAAM;AACd,QAAI;AACHA,oBAAG,MAAC,eAAe,KAAK,KAAK,UAAU,IAAI,CAAC;AAAA,IAC5C,SAAQ,GAAG;AACXA,oBAAA,MAAA,MAAA,SAAA,8BAAc,WAAW,CAAC;AAAA,IAC1B;AAAA,EACD;AAAA,EAED,IAAI,KAAK,eAAe,MAAM;AAC7B,QAAI;AACH,YAAM,OAAOA,cAAAA,MAAI,eAAe,GAAG;AACnC,aAAO,OAAO,KAAK,MAAM,IAAI,IAAI;AAAA,IACjC,SAAQ,GAAG;AACXA,oBAAA,MAAA,MAAA,SAAA,8BAAc,WAAW,CAAC;AAC1B,aAAO;AAAA,IACP;AAAA,EACD;AAAA,EAED,OAAO,KAAK;AACX,QAAI;AACHA,0BAAI,kBAAkB,GAAG;AAAA,IACzB,SAAQ,GAAG;AACXA,oBAAA,MAAA,MAAA,SAAA,8BAAc,WAAW,CAAC;AAAA,IAC1B;AAAA,EACD;AAAA,EAED,QAAQ;AACP,QAAI;AACHA,oBAAG,MAAC,iBAAgB;AAAA,IACpB,SAAQ,GAAG;AACXA,oBAAA,MAAA,MAAA,SAAA,8BAAc,WAAW,CAAC;AAAA,IAC1B;AAAA,EACD;AACF;AAEY,MAAC,cAAc;AAAA,EAC1B,aAAa;AACZ,WAAO,QAAQ,IAAI,YAAY,SAAS,CAAE,CAAA;AAAA,EAC1C;AAAA,EAED,YAAY,SAAS;AACpB,YAAQ,IAAI,YAAY,SAAS,OAAO;AAAA,EACxC;AAAA,EAED,iBAAiB;AAChB,WAAO,QAAQ,IAAI,YAAY,cAAc,CAAE,CAAA;AAAA,EAC/C;AAAA,EAED,eAAe,QAAQ;AACtB,UAAM,UAAU,KAAK;AACrB,YAAQ,QAAQ,MAAM;AACtB,YAAQ,IAAI,YAAY,cAAc,OAAO;AAAA,EAC7C;AAAA,EAED,kBAAkB,UAAU,OAAO;AAClC,UAAM,UAAU,KAAK;AACrB,UAAM,cAAc,QAAQ,UAAU,OAAK,EAAE,OAAO,QAAQ;AAC5D,QAAI,gBAAgB,IAAI;AACvB,cAAQ,WAAW,EAAE,cAAc;AACnC,WAAK,YAAY,OAAO;AAAA,IACxB;AAAA,EACD;AAAA,EAED,eAAe;AACd,YAAQ,OAAO,YAAY,OAAO;AAClC,YAAQ,OAAO,YAAY,YAAY;AAAA,EACvC;AACF;;;;"}